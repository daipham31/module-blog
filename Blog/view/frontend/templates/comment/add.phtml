<?php
   $block = $this->getLayout()
    ->createBlock('Duud\Blog\Block\Comment\Load');
?>
<form method="POST" name="comment_form" id="comment_form">
    <span>Nick Name:<input name="author" id="author" title="author" class="author" type="text"></span>
    <span>Text Comment:<input name="content" id="content" title="content" class="content" type="text"><br></span>
    <span>Email:<input name="email" id="email" title="email" class="email" type="text"></span>
    <input type="hidden" name="post_id" value="<?php echo $block->getPostID() ?>"/>
    <br><button id="submit_demo_data">Submit Comment</button>
</form>
<table id='display_data'>
    <tr>
        <th>Email</th><th>Nick Name</th><th>Text Comment</th>
    </tr>
</table>

<script type="text/javascript">
    require([
        "jquery",
        "mage/mage"
    ],function($) {
        $(document).ready(function() {
            $('#comment_form').mage(
                'validation',
                {
                    submitHandler: function(form) {
                        var customurl = "<?php echo $this->getUrl().'blog/comment/save'?>";
                        $.ajax({
                            url: customurl,
                            data: $('#comment_form').serialize(),
                            type: 'POST',
                            dataType: 'json',
                            showLoader: true,
                            cache: false,
                            success: function(data, status, xhr) {
                                $('#display_data').append("<tr><td>" + data.email + "</td><td>" + data.author + "</td><td>" + data.content + "</td></tr>");
                                $("#comment_form").trigger('reset');
                            },
                            error: function (xhr, status, errorThrown) {
                                alert(data);
                                console.log('Error happens. Try again.');
                                console.log(errorThrown);
                            }
                        });
                    }
                }
            );
        });
    });
</script>